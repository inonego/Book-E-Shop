#include "program.h"
#include "Util.h"

#include <set>
#include <format>

DataManager Program::data_manager;
MenuManager Program::menu_manager;
ShopManager Program::shop_manager;

void Program::Run()
{
	LoadCSV();
	SetCommand();
	SetParser();
	SetMenu();

	menu_manager.Start(MENU_START);
}

void Program::LoadCSV()
{
	// Product CSV ÆÄÀÏÀ» ÆÄ½ÌÇÕ´Ï´Ù.
	auto product_raw = data_manager.ParseCSV("./data/product.csv");
	for (size_t i = 0; i < product_raw.size(); i++) {
		// »ı¼ºµÈ Product °´Ã¼¸¦ shop_manager¿¡ Ãß°¡ÇÕ´Ï´Ù.
		shop_manager.AddProduct(new Product(product_raw[i]));
	}

	// Account CSV ÆÄÀÏÀ» ÆÄ½ÌÇÕ´Ï´Ù.
	auto account_raw = data_manager.ParseCSV("./data/account.csv");
	for (size_t i = 0; i < account_raw.size(); i++) {
		// »ı¼ºµÈ Account °´Ã¼¸¦ shop_manager¿¡ Ãß°¡ÇÕ´Ï´Ù.
		shop_manager.AddAccount(new Account(account_raw[i]));
	}

	// Invoice CSV ÆÄÀÏÀ» ÆÄ½ÌÇÕ´Ï´Ù.
	auto invoice_raw = data_manager.ParseCSV("./data/invoice.csv");
	for (size_t i = 0; i < invoice_raw.size(); i++) {
		// »ı¼ºµÈ Invoice °´Ã¼¸¦ shop_manager¿¡ Ãß°¡ÇÕ´Ï´Ù.
		shop_manager.AddInvoice(new Invoice(invoice_raw[i]));
	}
}

void Program::SaveCSV() {
	vector<vector<string>>raw_data;

	for (size_t i = 0; i < shop_manager.GetProductList().size(); i++) {
		raw_data.push_back(shop_manager.GetProductList()[i]->ToArray());
	}
	data_manager.SaveCSV("./data/product.csv", raw_data);

	raw_data.clear();

	for (size_t i = 0; i < shop_manager.GetAccountList().size(); i++) {
		raw_data.push_back(shop_manager.GetAccountList()[i]->ToArray());
	}
	data_manager.SaveCSV("./data/account.csv", raw_data);

	raw_data.clear();

	for (size_t i = 0; i < shop_manager.GetInvoiceList().size(); i++) {
		raw_data.push_back(shop_manager.GetInvoiceList()[i]->ToArray());
	}
	data_manager.SaveCSV("./data/invoice.csv", raw_data);
}

void Program::SetCommand()
{
	menu_manager.AppendCommand('z', new MenuManager::Command("µÚ·Î°¡±â", [&]() {
		menu_manager.RunPreviousMenu();
	}));

	menu_manager.AppendCommand('l', new MenuManager::Command("·Î±×¾Æ¿ô", [&]() {
		menu_manager.RunRecursiveMenu(MENU_LOGOUT);
	}));

	menu_manager.AppendCommand('q', new MenuManager::Command("Á¾·á", [&]() {
		menu_manager.RunRecursiveMenu(MENU_QUIT);
	}));
}

#pragma region Parser ±¸Çö
void Program::SetParser()
{
#pragma region »óÇ° µî·Ï Á¤º¸ Parser

	// »óÇ° µî·Ï Á¤º¸ °íÀ¯ ¹øÈ£
	data_manager.AppendParser("product_id", (new Parser())
		->set_label("°íÀ¯¹øÈ£")
		->set_regex(R"(^[0-9]{6}$)")
		->set_msg_error("¼ıÀÚ·Î ±¸¼ºµÈ ±æÀÌ°¡ 6ÀÎ ¹®ÀÚ¿­ÀÌ¾î¾ß ÇÕ´Ï´Ù.")
	);

	// »óÇ° µî·Ï Á¤º¸ Á¦¸ñ
	data_manager.AppendParser("product_title", (new Parser())
		->set_label("Á¦¸ñ")
	);

	// »óÇ° µî·Ï Á¤º¸ Àå¸£
	data_manager.AppendParser("product_genre", (new Parser())
		->set_label("Àå¸£")
	);

	// »óÇ° µî·Ï Á¤º¸ °¡°İ
	data_manager.AppendParser("product_price", (new Parser())
		->set_label("°¡°İ")
		->set_regex(R"(^[0-9]+$)")
		->set_msg_error("¼ıÀÚ·Î ±¸¼ºµÈ ±æÀÌ°¡ 1 ÀÌ»óÀÇ ¹®ÀÚ¿­ÀÌ¾î¾ß ÇÕ´Ï´Ù.")
	);

	// »óÇ° µî·Ï Á¤º¸ Àç°í
	data_manager.AppendParser("product_count", (new Parser())
		->set_label("Àç°í")
		->set_regex(R"(^[0-9]+$)")
		->set_msg_error("¼ıÀÚ·Î ±¸¼ºµÈ ±æÀÌ°¡ 1 ÀÌ»óÀÇ ¹®ÀÚ¿­ÀÌ¾î¾ß ÇÕ´Ï´Ù.")
	);
#pragma endregion

#pragma region °í°´ °èÁ¤ Á¤º¸ Parser

	// °í°´ °èÁ¤ Á¤º¸ ÀÌ¸§
	data_manager.AppendParser("account_name", (new Parser())
		->set_label("ÀÌ¸§")
		->set_regex(R"(^[ ]*[a-zA-Z°¡-ÆR]+[a-zA-Z°¡-ÆR]*$)")
		->set_msg_error("ÀÌ¸§Àº °ø¹é, ¿µ¹®ÀÚ, ÇÑ±Û Çã¿ëÇÑ °ø¹éÀ» Á¦¿ÜÇÑ ±æÀÌ°¡ 1 ÀÌ»óÀÎ ¹®ÀÚ¿­ÀÌ¾î¾ß ÇÕ´Ï´Ù!")
	);

	// °í°´ °èÁ¤ Á¤º¸ ¾ÆÀÌµğ
	data_manager.AppendParser("account_id", (new Parser())
		->set_label("¾ÆÀÌµğ")
		->set_regex(R"(^[0-9a-zA-Z]{4,12}$)")
		->set_msg_error("¾ÆÀÌµğ´Â ¼ıÀÚ, ¿µ¹®ÀÚ·Î ±¸¼ºµÈ ±æÀÌ°¡ 4 ÀÌ»ó 12 ÀÌÇÏÀÇ ¹®ÀÚ¿­ÀÌ¾î¾ß ÇÕ´Ï´Ù!")
	);

	// °í°´ °èÁ¤ Á¤º¸ ºñ¹Ğ¹øÈ£
	data_manager.AppendParser("account_password", (new Parser())
		->set_label("ºñ¹Ğ¹øÈ£")
		->set_regex(R"(^[0-9a-zA-Z!@#$%^&*_]{8,16}$)")
		->set_msg_error("ºñ¹Ğ¹øÈ£´Â ¼ıÀÚ, ¿µ¹®ÀÚ, Æ¯¼ö ¹®ÀÚ(!@#$%^&*_)·Î ±¸¼ºµÈ ±æÀÌ°¡ 8 ÀÌ»ó 16 ÀÌÇÏÀÇ ¹®ÀÚ¿­ÀÌ¾î¾ß ÇÕ´Ï´Ù!")
	);

	// °í°´ °èÁ¤ Á¤º¸ ÀüÈ­¹øÈ£
	data_manager.AppendParser("account_phonenumber", (new Parser())
		->set_label("ÀüÈ­¹øÈ£")
		->set_regex(R"(^010[0-9]{8}$)")
		->set_msg_error("ÀüÈ­¹øÈ£´Â ¼ıÀÚ·Î ±¸¼ºµÇ¾î 010À¸·Î ½ÃÀÛÇÏ°í, ±æÀÌ°¡ 11ÀÇ ¹®ÀÚ¿­ÀÌ¾î¾ß ÇÕ´Ï´Ù!")
	);

	// °í°´ °èÁ¤ Á¤º¸ ÁÖ¼Ò
	data_manager.AppendParser("account_address", (new Parser())
		->set_label("ÁÖ¼Ò")
	);
#pragma endregion

#pragma region ÁÖ¹® Ã³¸® Á¤º¸ Parser
	// ÁÖ¹® Ã³¸® Á¤º¸ °íÀ¯¹øÈ£
	data_manager.AppendParser("invoice_id", (new Parser())
		->set_label("°íÀ¯¹øÈ£")
		->set_regex(R"(^[0-9]{8}$)")
		->set_msg_error("¼ıÀÚ·Î ±¸¼ºµÈ ±æÀÌ°¡ 8ÀÎ ¹®ÀÚ¿­ÀÌ¾î¾ß ÇÕ´Ï´Ù")
	);

	// ÁÖ¹® Ã³¸® Á¤º¸ ±¸¸ÅÀÚÀÇ ¾ÆÀÌµğ
	data_manager.AppendParser("invoice_buyer_id", (new Parser())
		->set_label("±¸¸ÅÀÚÀÇ ¾ÆÀÌµğ")
		->set_msg_info("±¸¸ÅÀÚÀÇ ¾ÆÀÌµğ ÀÔ´Ï´Ù.")
	);

	// ÁÖ¹® Ã³¸® Á¤º¸ ¼ö·ÉÀÎÀÇ ÀüÈ­¹øÈ£
		data_manager.AppendParser("invoice_recipient_phonenumber", (new Parser())
		->set_label("¼ö·ÉÀÎÀÇ ÀüÈ­¹øÈ£")
		->set_msg_info("¼ö·ÉÀÎÀÇ ÀüÈ­¹øÈ£ ÀÔ´Ï´Ù.")
	);

	// ÁÖ¹® Ã³¸® Á¤º¸ ¼ö·ÉÀÎÀÇ ÁÖ¼Ò
	data_manager.AppendParser("invoice_recipient_address", (new Parser())
		->set_label("¼ö·ÉÀÎÀÇ ÁÖ¼Ò")
		->set_msg_info("¼ö·ÉÀÎÀÇ ÁÖ¼Ò ÀÔ´Ï´Ù.")
	);

	// ÁÖ¹® Ã³¸® Á¤º¸ ±¸¸Å ³¯Â¥
	data_manager.AppendParser("invoice_date", (new Parser())
		->set_label("±¸¸Å ³¯Â¥")
	);

	// ÁÖ¹® Ã³¸® Á¤º¸ »óÇ° °íÀ¯ ¹øÈ£
	data_manager.AppendParser("invoice_product_id", (new Parser())
		->set_label("»óÇ° °íÀ¯ ¹øÈ£")
		->set_msg_info("±¸¸ÅÇÑ »óÇ° °íÀ¯ ¹øÈ£ ÀÔ´Ï´Ù.")
	);

	// ÁÖ¹® Ã³¸® Á¤º¸ »óÇ° ¼ö·®
	data_manager.AppendParser("invoice_product_count", (new Parser())
		->set_label("»óÇ° ¼ö·®")
		->set_regex(R"(^[1-9][0-9]*$)")
		->set_msg_error("¼ıÀÚ·Î ±¸¼ºµÈ ±æÀÌ°¡ 1 ÀÌ»óÀÇ ¹®ÀÚ¿­ÀÌ¾î¾ß ÇÕ´Ï´Ù,")
	);
#pragma endregion


	data_manager.AppendParser("MENU_MENUSELECTION", (new Parser())
		->set_regex(R"(\d)")
		->set_msg_error("¸Ş´º¿¡ Ç¥½ÃµÈ ¹øÈ£ Áß ÇÏ³ª¸¦ °í¸£¼¼¿ä.")
	);

	data_manager.AppendParser("MENU_TABLE", (new Parser())
		->set_regex(R"(^[0-9a-zA-Z]$)")
		->set_msg_error("¸Ş´º¿¡ Ç¥½ÃµÈ ¹øÈ£ ¶Ç´Â ¾ËÆÄºª Áß ÇÏ³ª¸¦ °í¸£¼¼¿ä.")
	);
}
#pragma endregion

#pragma region ¸Ş´ºÈ­¸é ±¸Çö

void Program::SetMenu()
{	
#pragma region °øÅë ¸Ş´ºÈ­¸é
	menu_manager.AppendMenu(MENU_QUIT, new Menu([&](MenuIO& IO) {
		menu_manager.ToggleCommand();
		menu_manager.PrintCommand();

		IO.print_line();
		IO.print_aligned_center("[ ÇÁ·Î±×·¥ Á¾·á ]");
		IO.print("ÇÁ·Î±×·¥À» Á¾·áÇÏ½Ã°Ú½À´Ï±î? (y / n)\n");
		string input = IO.input();

		if (input == "y") {
			SaveCSV();
			exit(0);
		}
		}));

	menu_manager.AppendMenu(MENU_LOGOUT, new Menu([&](MenuIO& IO) {
		menu_manager.ToggleCommand();
		menu_manager.PrintCommand();

		IO.print_line();
		IO.print_aligned_center("[ °èÁ¤ ·Î±×¾Æ¿ô ]");
		IO.print("°èÁ¤¿¡¼­ ·Î±×¾Æ¿ô ÇÏ½Ã°Ú½À´Ï±î? (y / n)\n");
		string input = IO.input();

		if (input == "y") {
			shop_manager.Logout();

			menu_manager.RunMenu(MENU_START);
		}
		}));
#pragma endregion


#pragma region ½ÃÀÛ ¸Ş´ºÈ­¸é
	// ½ÃÀÛ ¸Ş´ºÈ­¸é
	{
		TemplateMenuSelection _template;
		_template.ToggleCommand('q');
		_template.SetName("½ÃÀÛ ¸Ş´º");
		_template.SubMenu("°èÁ¤ ·Î±×ÀÎ",   [&]() { menu_manager.RunMenu(MENU_LOGIN);  });	
		_template.SubMenu("°èÁ¤ È¸¿ø°¡ÀÔ", [&]() { menu_manager.RunMenu(MENU_SIGNUP); });
		_template.Apply(MENU_START);
	} 

	// °èÁ¤ ·Î±×ÀÎ ¸Ş´ºÈ­¸é
	menu_manager.AppendMenu(MENU_LOGIN, new Menu(
		[&](MenuIO& IO) { 
			menu_manager.ToggleCommand('z', 'q');
			menu_manager.PrintCommand();
			IO.print_line();
			IO.print_aligned_center("[ °èÁ¤ ·Î±×ÀÎ ]");

			string id, password;

			auto checkpoint = IO.checkpoint();

			while (true) {
				// ¾ÆÀÌµğ¸¦ ÀÔ·Â¹Ş½À´Ï´Ù.
				id = IO.input("", "¾ÆÀÌµğ");
				// ºñ¹Ğ¹øÈ£¸¦ ÀÔ·Â¹Ş½À´Ï´Ù.
				password = IO.input("", "ºñ¹Ğ¹øÈ£");

				const Account* user;

				// ÀÏÄ¡ÇÏ´Â °èÁ¤ Á¤º¸°¡ ÀÖ´ÂÁö È®ÀÎÇÕ´Ï´Ù.
				if ((user = shop_manager.Login(id, password)) != nullptr) {
					if (user == shop_manager.GetAdminAccount()) {
						menu_manager.RunMenu(MENU_ADMIN);
					}
					else {
						menu_manager.RunMenu(MENU_BUYER);
					}
				}
				else {
					IO.print("¾ÆÀÌµğ°¡ Á¸ÀçÇÏÁö ¾Ê°Å³ª ºñ¹Ğ¹øÈ£°¡ ¿Ã¹Ù¸£Áö ¾Ê½À´Ï´Ù.\n");
					IO.pause();

					IO.rollback(checkpoint);
				}
			}
		}
	));

	// °èÁ¤ È¸¿ø°¡ÀÔ ¸Ş´ºÈ­¸é
	menu_manager.AppendMenu(MENU_SIGNUP, new Menu(
		[&](MenuIO& IO) {
			menu_manager.ToggleCommand('z', 'q');
			menu_manager.PrintCommand();
			IO.print_line();
			IO.print_aligned_center("[ °èÁ¤ È¸¿ø°¡ÀÔ ]");

			vector<string> account;
			
			vector<string> parser_key = { "account_name", "account_id", "account_password", "", "account_phonenumber", "account_address" };

			for (int i = 0; i < parser_key.size(); i++) {				
				if (i == 1) {
					// '¾ÆÀÌµğ' ÀÔ·Â
					auto checkpoint = IO.checkpoint();

					while (true) {
						string input = IO.input(data_manager.GetParser(parser_key[i]));

						// ÀÔ·ÂµÈ ¾ÆÀÌµğ°¡ °ü¸®ÀÚ °èÁ¤¿¡ ÇØ´çÇÏ´ÂÁö È®ÀÎÇÕ´Ï´Ù.
						if (input != shop_manager.GetAdminAccount()->id) {
							// ÀÔ·ÂµÈ ¾ÆÀÌµğ°¡ °í°´ °èÁ¤ Á¤º¸°¡ ÀÖ´ÂÁö È®ÀÎÇÕ´Ï´Ù.
							if (shop_manager.GetAccount(input) == nullptr) {
								account.push_back(input);

								break;
							}
							else {
								IO.print("ÀÌ¹Ì Á¸ÀçÇÏ´Â ¾ÆÀÌµğÀÔ´Ï´Ù.\n");
								IO.pause();

								IO.rollback(checkpoint);
							}
						}
						else {
							IO.print(format("°ü¸®ÀÚ ¾ÆÀÌµğ '{}'Àº ¾ÆÀÌµğ·Î »ç¿ëÇÒ ¼ö ¾ø½À´Ï´Ù.\n", shop_manager.GetAdminAccount()->id));
							IO.pause();

							IO.rollback(checkpoint);
						}
					}
				}
				else if (i == 3) {
					// 'ºñ¹Ğ¹øÈ£ È®ÀÎ' ÀÔ·Â
					auto checkpoint = IO.checkpoint();

					while (true) {
						string input = IO.input("", "ºñ¹Ğ¹øÈ£ È®ÀÎ");

						if (input == account[2]) {
							break;
						}
						else
						{
							IO.print("'ºñ¹Ğ¹øÈ£ È®ÀÎ'ÀÌ 'ºñ¹Ğ¹øÈ£'¿Í ÀÏÄ¡ÇÏÁö ¾Ê½À´Ï´Ù.\n");
							IO.pause();

							IO.rollback(checkpoint);
						}
					}
				}
				else {
					// °¢°¢ÀÇ µ¥ÀÌÅÍ ¿ä¼Ò ÀÔ·Â¿¡ ´ëÇÑ Çü½ÄÀ» È®ÀÎÇÏ°í ÀúÀåÇÕ´Ï´Ù.
					account.push_back(IO.input(data_manager.GetParser(parser_key[i])));
				}
			}
			
			//ÁÖ¹® Ã³¸® Á¤º¸ ¸ñ·Ï
			account.push_back("");

			IO.print("\n°èÁ¤À» »ı¼ºÇÏ½Ã°Ú½À´Ï±î? (y / n)\n");
			string input = IO.input();

			if (input == "y") {
				shop_manager.AddAccount(new Account(account));
			
				IO.print("\n°èÁ¤ÀÌ »ı¼ºµÇ¾ú½À´Ï´Ù.\n");
				IO.pause();
			}
			 
			menu_manager.RunMenu(MENU_START);
		}
	));
#pragma endregion

#pragma region °ü¸®ÀÚ ¸Ş´ºÈ­¸é
	// °ü¸®ÀÚ ¸Ş´ºÈ­¸é
	{
		TemplateMenuSelection _template;
		_template.ToggleCommand('l', 'q'); 
		_template.SetName("°ü¸®ÀÚ ¸Ş´ºÈ­¸é");
		_template.SubMenu("»óÇ° °ü¸® (µî·Ï/¼öÁ¤/Á¦°Å, Àç°í°ü¸®)", [&]() { menu_manager.RunMenu(MENU_A_PRODUCT_LIST, shop_manager.GetProductList()); });
		_template.SubMenu("°í°´ °ü¸® (°èÁ¤, ÁÖ¹®)",				  [&]() { menu_manager.RunMenu(MENU_A_ACCOUNT_LIST, shop_manager.GetAccountList()); });
		_template.Apply(MENU_ADMIN);
	}

	#pragma region »óÇ° ¸ñ·Ï
	// »óÇ° ¸ñ·Ï ¸Ş´ºÈ­¸é
	{
		TemplateTable<Product*> _template;
		_template.SetName("»óÇ° ¸ñ·Ï");

		// Å×ÀÌºí Ãâ·Â Çü½Ä ÁöÁ¤ 
		_template.header_func = []() -> string {
			return format("{0:<10}{1:<20}{2:<8}{3:<12}{4:<8}", "ID", "»óÇ°", "Àå¸£", "°¡°İ", "Àç°í");
		};
		_template.show_func = [](Product* product) -> string {
			return format("{0:<10}{1:<20}{2:<8}{3:<12}{4:<8}", product->id, limit(product->title, 18), product->genre, to_string(product->price) + "¿ø", product->count);
		}; 

		// ¸Ş´º Ãß°¡ ¹× ±â´É
		_template.SubMenu('p', "»óÇ° °Ë»ö ¹× Àå¸£ ¼±ÅÃ", []() {
			set<string> genre_set;

			vector<Product*>& product_list = shop_manager.GetProductList(); 

			for (int i = 0; i < product_list.size(); i++) {
				Product* product = product_list[i];

				genre_set.insert(product->genre);
			}

			static vector<string> genre_list; genre_list = vector<string>(genre_set.begin(), genre_set.end());

			for (int i = 0; i < genre_list.size(); i += 10) {
				genre_list.insert(genre_list.begin() + i, "ÀüÃ¼");
			}

			menu_manager.RunMenu(MENU_A_PRODUCT_SEARCH, genre_list);
		});

		_template.SubMenu('r', "»óÇ° ½Å±Ô µî·Ï",         [&]() { menu_manager.RunMenu(MENU_A_PRODUCT_REGISTER);  });

		_template.next_menu_code = MENU_A_PRODUCT_INFO;

		_template.Apply(MENU_A_PRODUCT_LIST);
	}  

	// »óÇ° °Ë»ö ¹× Àå¸£ ¼±ÅÃ ¸Ş´ºÈ­¸é
	{
		TemplateTable<string> _template;
		_template.SetName("»óÇ° °Ë»ö ¹× Àå¸£ ¼±ÅÃ");
		_template.header_func = []() -> string {
			return "Àå¸£";
		};
		_template.show_func = [](string genre) -> string {
			return genre;
		};
		 
		_template.next_menu_code = MENU_A_PRODUCT_LIST; 

		_template.process_func = [&](MenuIO& IO, MenuCode next_menu_code, string genre) {
			string input = IO.input("", "Á¦¸ñ");

			vector<Product*>& product_list = shop_manager.GetProductList();

			static vector<Product*> result; result.clear();

			for (int i = 0; i < product_list.size(); i++) {
				Product* product = product_list[i];

				if ((input == "" || product->title == input) && (genre == "ÀüÃ¼" || product->genre == genre)) {
					result.push_back(product);
				}
			}
			 
			menu_manager.RunMenu(next_menu_code, result);
		};

		_template.Apply(MENU_A_PRODUCT_SEARCH);
	}

	// »óÇ° ½Å±Ô µî·Ï ¸Ş´ºÈ­¸é
	menu_manager.AppendMenu(MENU_A_PRODUCT_REGISTER, new Menu(
		[&](MenuIO& IO) {
			menu_manager.PrintCommand();
			IO.print_line();
			IO.print_aligned_center("[ »óÇ° ½Å±Ô µî·Ï ]");

			vector<string> product;

			vector<string> parser_key = { "product_title", "product_genre", "product_price", "product_count" };
			
			int id = shop_manager.GetProductList().size();

			product.push_back(to_string(id));

			for (int i = 0; i < parser_key.size(); i++) {
				product.push_back(IO.input(data_manager.GetParser(parser_key[i])));
			}

			IO.print("\n»óÇ°À» µî·ÏÇÏ½Ã°Ú½À´Ï±î? (y / n)\n");
			string input = IO.input();

			if (input == "y") {
				shop_manager.AddProduct(new Product(product));
				
				IO.print(format("\n»óÇ°({})ÀÌ µî·ÏµÇ¾ú½À´Ï´Ù.\n", id));
				IO.pause();

				// »óÇ°À» µî·ÏÇÑ °æ¿ì ÀÌÀü ¸Ş´º·Î µ¹¾Æ°¡ ÀüÃ¼ »óÇ° µî·Ï Á¤º¸¸¦ º¸¿©Áİ´Ï´Ù.
				menu_manager.RunMenu(MENU_A_PRODUCT_LIST, shop_manager.GetProductList());
			}

			// »óÇ°À» µî·ÏÇÏÁö ¾ÊÀº °æ¿ì ÀÌÀü °Ë»ö »óÅÂ¸¦ À¯ÁöÇÏ¸é¼­ ÀÌÀü ¸Ş´º¸¦ º¸¿©Áİ´Ï´Ù.
		} 
	));

	// »óÇ° µî·Ï Á¤º¸ ¸Ş´ºÈ­¸é
	menu_manager.AppendMenu(MENU_A_PRODUCT_INFO, new Menu<Product*>(
		[&](MenuIO& IO, Product* target) { 
			menu_manager.PrintCommand(); 
			IO.print_line(); 
			IO.print_aligned_center("[ »óÇ° µî·Ï Á¤º¸ ]");

			IO.print(format("°íÀ¯¹øÈ£ : {0}\n", target->id));
			IO.print(format("Á¦¸ñ : {0}\n", target->title));
			IO.print(format("Àå¸£ : {0}\n", target->genre));
			IO.print(format("°¡°İ : {0}\n", target->price));
			IO.print(format("Àç°í : {0}\n", target->count));

			IO.print_line();

			IO.print_aligned_center("¼öÁ¤(M)     Á¦°Å(R)");

			IO.print_line();

			auto checkpoint = IO.checkpoint();

			while (true) {
				string input = IO.input();

				if (input.size() == 1) {
					char command = tolower(input[0]);

					if (command == 'm') {
						menu_manager.RunMenu(MENU_A_PRODUCT_INFO_M, target);
					}
					else if (command == 'r') { 
						menu_manager.RunMenu(MENU_A_PRODUCT_INFO_R, target);
					}
				} 

				IO.print("¸Ş´º¿¡ Ç¥½ÃµÈ ¾ËÆÄºª Áß ÇÏ³ª¸¦ °í¸£¼¼¿ä.\n");
				IO.pause();

				IO.rollback(checkpoint);
			}
		}
	));

	// »óÇ° µî·Ï Á¤º¸ ¼öÁ¤ ¸Ş´ºÈ­¸é
	menu_manager.AppendMenu(MENU_A_PRODUCT_INFO_M, new Menu<Product*>(
		[&](MenuIO& IO, Product* target)  {
			menu_manager.PrintCommand();
			IO.print_line();
			IO.print_aligned_center("[ »óÇ° µî·Ï Á¤º¸ ¼öÁ¤ ]");

			vector<string> product = target->ToArray();

			vector<string> parser_key = { "product_title","product_genre","product_price","product_count" };

			for (int i = 0; i < parser_key.size(); i++) { 
				auto checkpoint = IO.checkpoint();

				while (true) { 
					Parser* parser = data_manager.GetParser(parser_key[i]);

					string input = IO.input("", parser->label);
					if (input == "" || parser->Check(input)) { 
						if (product[i] != "") {
							product[i] = input;
						}

						break;
					}
					else
					{
						IO.print(parser->msg_error);
						IO.pause();

						IO.rollback(checkpoint);
					}
				} 
			}

			string input = IO.input("»óÇ° µî·Ï Á¤º¸¸¦ ¼öÁ¤ÇÏ½Ã°Ú½À´Ï±î? (y / n)", "");

			if (input == "y") {
				*target = Product(product);

				IO.print(format("»óÇ°({})ÀÇ µî·Ï Á¤º¸°¡ ¼öÁ¤µÇ¾ú½À´Ï´Ù.", target->id));

				IO.pause();
			}

			menu_manager.RunMenu(MENU_A_PRODUCT_INFO, target);
		}
	));

	// »óÇ° µî·Ï Á¤º¸ Á¦°Å ¸Ş´ºÈ­¸é
	menu_manager.AppendMenu(MENU_A_PRODUCT_INFO_R, new Menu<Product*>(
		[&](MenuIO& IO, Product* target) {
			menu_manager.PrintCommand();
			IO.print_line();
			IO.print_aligned_center("[ »óÇ° µî·Ï Á¤º¸ Á¦°Å ]");
			string input = IO.input("»óÇ° µî·Ï Á¤º¸¸¦ Á¦°ÅÇÏ½Ã°Ú½À´Ï±î?(y/n)");
			if (input == "y") {
				IO.print(format("\n»óÇ°({0})ÀÇ µî·Ï Á¤º¸°¡ Á¦°ÅµÇ¾ú½À´Ï´Ù.\n", target->id));
				shop_manager.RemoveProduct(target->id);
				IO.pause();

				menu_manager.RunMenu(MENU_A_PRODUCT_LIST, shop_manager.GetProductList());
			}
		}
	));
	#pragma endregion 

	#pragma region °í°´ ¸ñ·Ï
	// °í°´ ¸ñ·Ï ¸Ş´ºÈ­¸é 
	{
		TemplateTable<Account*> _template;
		_template.SetName("°í°´ ¸ñ·Ï");
		_template.header_func = []() -> string {
			return format("{0:<16}{1:<8}{2:<16}", "¾ÆÀÌµğ", "ÀÌ¸§", "ÀüÈ­¹øÈ£");
		};
		_template.show_func = [](Account* product) -> string {
			return format("{0:<16}{1:<8}{2:<16}", product->id, product->name, product->phone_number);
		};
		_template.SubMenu('p', "°í°´ °Ë»ö", [&]() { menu_manager.RunMenu(MENU_A_PRODUCT_SEARCH);  });

		_template.next_menu_code = MENU_A_ACCOUNT_INFO;

		_template.Apply(MENU_A_ACCOUNT_LIST);
	}


	// °í°´ °Ë»ö ¸Ş´ºÈ­¸é
	menu_manager.AppendMenu(MENU_A_ACCOUNT_SEARCH, new Menu(
		[&](MenuIO& IO) {
			menu_manager.PrintCommand();
			IO.print_line();
			IO.print_aligned_center("[ °í°´ °Ë»ö ]");
		}
	));
	
	// °í°´ °èÁ¤ Á¤º¸ ¸Ş´ºÈ­¸é
	menu_manager.AppendMenu(MENU_A_ACCOUNT_INFO, new Menu<Account*>(
		[&](MenuIO& IO, Account* target) {
			menu_manager.PrintCommand();
			IO.print_line();
			IO.print_aligned_center("[ °í°´ °èÁ¤ Á¤º¸ ]");

			IO.print(format("ÀÌ¸§ : {0}\n", target->name));
			IO.print(format("¾ÆÀÌµğ : {0}\n", target->id));
			IO.print(format("ÀüÈ­¹øÈ£ : {0}\n", target->phone_number));
			IO.print(format("ÁÖ¼Ò : {0}\n", target->address));

			IO.print_line();

			IO.print("ÁÖ¹® Ã³¸® Á¤º¸(O)     ¼öÁ¤(M)");

			IO.print_line();

			auto checkpoint = IO.checkpoint();

			while (true) {
				string input = IO.input();

				if (input == "O") {
					menu_manager.RunMenu(MENU_A_INVOICE_LIST, target->invoice_id_list);
				}
				else if (input == "M") {
					menu_manager.RunMenu(MENU_A_ACCOUNT_INFO_M, target);
				}
				else {
					IO.print("ÀÏÄ¡ÇÏ´Â ¸í·É¾î°¡ ¾øÀ½.\n");
					IO.pause();

					IO.rollback(checkpoint);
				}
			}

		}
	));

	// °í°´ °èÁ¤ Á¤º¸ ¼öÁ¤ ¸Ş´ºÈ­¸é
	menu_manager.AppendMenu(MENU_A_ACCOUNT_INFO_M, new Menu<Account*>(
		[&](MenuIO& IO, Account* target) {
			menu_manager.PrintCommand();
			IO.print_line();
			IO.print_aligned_center("[ °í°´ °èÁ¤ Á¤º¸ ¼öÁ¤ ]");

			auto checkpoint = IO.checkpoint();
			vector<string> account;
			string input, match_p;
			vector<string> heads = { "ºñ¹Ğ¹øÈ£","ºñ¹Ğ¹øÈ£ È®ÀÎ","ÀüÈ­¹øÈ£","ÁÖ¼Ò" };
			vector<string> regex_t = { "account_password","","account_phonenumber","account_address" };
			int t = 0;
			while (t < heads.size()) {
				if (t != 1) {
					checkpoint = IO.checkpoint();
					input = IO.input("", heads[t]);
					if (data_manager.GetParser(regex_t[t])->Check(input) || input._Equal("")) {
						account.push_back(input);
						t++;
					}
					else
					{
						IO.print(data_manager.GetParser(regex_t[t])->msg_error);
						IO.pause();
						IO.rollback(checkpoint);
					}
				}
				else{
					checkpoint = IO.checkpoint();
					match_p = IO.input("", heads[t]);
					if (input._Equal(match_p))
						t++;
					else
					{
						IO.print("'ºñ¹Ğ¹øÈ£ È®ÀÎ'ÀÌ 'ºñ¹Ğ¹øÈ£'¿Í ÀÏÄ¡ÇÏÁö ¾Ê½À´Ï´Ù");
						IO.pause();
						IO.rollback(checkpoint);
					}
				}
			}
			input = IO.input("°èÁ¤ Á¤º¸¸¦ ¼öÁ¤ÇÏ½Ã°Ú½À´Ï±î?(y/n)", "");
			if (input == "y") {
				target->password = account[0]._Equal("") ? target->password : account[0];
				target->phone_number = account[1]._Equal("") ? target->phone_number : account[1];
				target->address = account[2]._Equal("") ? target->address : account[2];
				IO.pause();
			}
		}
	));
	// ±¸¸Å ³»¿ª ¸Ş´ºÈ­¸é
	{
		TemplateTable<int> _template;
		_template.SetName("±¸¸Å ³»¿ª");
		_template.header_func = []() -> string {
			return format("{0:<12}{1:<20}{2:<16}", "±¸¸Å ³¯Â¥", "Á¦¸ñ", "°áÁ¦ ±İ¾×");
		};
		_template.show_func = [](int id) -> string {
			Invoice* invoice = shop_manager.GetInvoice(id);
			Product* product = shop_manager.GetProduct(invoice->product_id); 

			return format("{0:<12}{1:<20}{2:<16}", invoice->date, limit(product->title, 18), to_string(product->price * invoice->product_count) + "¿ø");
		};

		_template.next_menu_code = MENU_A_INVOICE_INFO;

		_template.Apply(MENU_A_INVOICE_LIST);
	}

	// ÁÖ¹® »ó¼¼ Á¤º¸ ¸Ş´ºÈ­¸é
	menu_manager.AppendMenu(MENU_A_INVOICE_INFO, new Menu<int>(
		[&](MenuIO& IO, int target_id) {
			menu_manager.PrintCommand();
			IO.print_line();
			IO.print_aligned_center("[ ÁÖ¹® »ó¼¼ Á¤º¸ ]");

			Invoice* target = shop_manager.GetInvoice(target_id);
			Product* product = shop_manager.GetProduct(target->product_id);
			Account* account = shop_manager.GetAccount(target->buyer_id);

			IO.print(format("±¸¸Å ³¯Â¥ : {0}\n", target->date));

			IO.print("\n[»óÇ° »ó¼¼ Á¤º¸]\n");
			IO.print(format("°íÀ¯ ¹øÈ£ : {0}\n", product->id));
			IO.print(format("Á¦¸ñ : {0}\n", product->title));
			IO.print(format("Àå¸£ : {0}\n", product->genre));
			IO.print(format("°¡°İ : {0}\n", product->price));

			IO.print("\n[ÁÖ¹®ÀÚ Á¤º¸]\n");
			IO.print(format("¾ÆÀÌµğ : {0}\n", account->id));
			IO.print(format("ÀÌ¸§ : {0}\n", account->name));
			IO.print(format("ÀüÈ­¹øÈ£ : {0}\n", target->recipient_phone_number));
			IO.print(format("ÁÖ¼Ò : {0}\n", target->recipient_address));

			IO.print("\n");
			IO.print(format("»óÇ° °íÀ¯ ¹øÈ£ : {0}\n", target->product_id));
			IO.print(format("»óÇ° ¼ö·® : {0}\n", target->product_count));
			IO.print(format("°áÁ¦ ±İ¾× : {0}\n", product->price * target->product_count));
			IO.print_line();
			IO.print("¾Æ¹« Å°³ª ÀÔ·ÂÇÏ¼¼¿ä\n");

			auto checkpoint = IO.checkpoint();
			string input = IO.input();

		}
	));
	#pragma endregion

#pragma endregion

#pragma region ±¸¸ÅÀÚ ¸Ş´ºÈ­¸é
	// ±¸¸ÅÀÚ ¸Ş´ºÈ­¸é
	{
		TemplateMenuSelection _template;
		_template.SetName("±¸¸ÅÀÚ ¸Ş´ºÈ­¸é");
		_template.ToggleCommand('l', 'q');
		_template.SubMenu("»óÇ° ¸ñ·Ï", [&]() { menu_manager.RunMenu(MENU_B_PRODUCT_LIST, ref(shop_manager.GetProductList())); });
		_template.SubMenu("°í°´ °èÁ¤ Á¤º¸", [&]() { menu_manager.RunMenu(MENU_B_ACCOUNT_INFO, shop_manager.GetUser()); });
		_template.Apply(MENU_BUYER);
	}

	// »óÇ° ¸ñ·Ï ¸Ş´ºÈ­¸é
	{
		TemplateTable<Product*> _template;
		_template.SetName("»óÇ° ¸ñ·Ï");
		_template.header_func = []() -> string {
			return format("{0:<10}{1:<20}{2:<8}{3:<12}{4:<8}", "ID", "»óÇ°", "Àå¸£", "°¡°İ", "Àç°í");
		};
		_template.show_func = [](Product* product) -> string {
			return format("{0:<10}{1:<20}{2:<8}{3:<12}{4:<8}", product->id, limit(product->title, 18), product->genre, to_string(product->price) + "¿ø", product->count);
		};
		_template.SubMenu('p', "»óÇ° °Ë»ö ¹× Àå¸£ ¼±ÅÃ", []() {
			set<string> genre_set;

			vector<Product*>& product_list = shop_manager.GetProductList();

			for (int i = 0; i < product_list.size(); i++) {
				Product* product = product_list[i];

				genre_set.insert(product->genre);
			}

			vector<string> genre_list(genre_set.begin(), genre_set.end());

			for (int i = 0; i < genre_list.size(); i += 10) {
				genre_list.insert(genre_list.begin() + i, "ÀüÃ¼");
			}

			menu_manager.RunMenu(MENU_B_PRODUCT_SEARCH, genre_list);
			});

		_template.next_menu_code = MENU_B_PRODUCT_INFO;

		_template.Apply(MENU_B_PRODUCT_LIST);
	}

	// »óÇ° °Ë»ö ¹× Àå¸£ ¼±ÅÃ ¸Ş´ºÈ­¸é
	{
		TemplateTable<string> _template;
		_template.SetName("»óÇ° °Ë»ö ¹× Àå¸£ ¼±ÅÃ");
		_template.header_func = []() -> string {
			return "Àå¸£";
		};
		_template.show_func = [](string genre) -> string {
			return genre;
		};

		_template.next_menu_code = MENU_B_PRODUCT_LIST;

		_template.process_func = [&](MenuIO& IO, MenuCode next_menu_code, string genre) {
			string input = IO.input("", "Á¦¸ñ");

			vector<Product*>& product_list = shop_manager.GetProductList();

			vector<Product*> result;

			for (int i = 0; i < product_list.size(); i++) {
				Product* product = product_list[i];

				if ((input == "" || product->title == input) && (genre == "ÀüÃ¼" || product->genre == genre)) {
					result.push_back(product);
				}
			}

			menu_manager.RunMenu(next_menu_code, result);
		};

		_template.Apply(MENU_B_PRODUCT_SEARCH);
	}

	// »óÇ° »ó¼¼ Á¤º¸ È®ÀÎ ¸Ş´ºÈ­¸é
	menu_manager.AppendMenu(MENU_B_PRODUCT_INFO, new Menu<Product*>(
		[&](MenuIO& IO, Product* target) {
			menu_manager.PrintCommand();
			IO.print_line();
			IO.print_aligned_center("[ »óÇ° µî·Ï Á¤º¸ ]");

			IO.print(format("°íÀ¯¹øÈ£ : {0}\n", target->id));
			IO.print(format("Á¦¸ñ : {0}\n", target->title));
			IO.print(format("Àå¸£ : {0}\n", target->genre));
			IO.print(format("°¡°İ : {0}\n", target->price));
			IO.print(format("Àç°í : {0}\n", target->count));

			IO.print_line();

			IO.print("±¸¸Å(B)\n");

			IO.print_line();

			auto checkpoint = IO.checkpoint();

			while (true) {
				string input = IO.input();

				if (input == "B") {
					menu_manager.RunMenu(MENU_B_PRODUCT_BUY, target);
				}
				else {
					IO.print("ÀÏÄ¡ÇÏ´Â ¸í·É¾î°¡ ¾øÀ½.\n");
					IO.pause();

					IO.rollback(checkpoint);
				}
			}
		}
	));
	// »óÇ° ±¸¸Å ¸Ş´ºÈ­¸é
	menu_manager.AppendMenu(MENU_B_PRODUCT_BUY, new Menu<Product*>(
		[&](MenuIO& IO, Product* target) {
			menu_manager.PrintCommand();
			IO.print_line();
			IO.print_aligned_center("[ »óÇ° ±¸¸Å ]");
			int count;
			string input;
			Account* user = shop_manager.GetUser();
			vector<string> invoice = { user->id,user->phone_number,user->address, "23.10.29", to_string(target->id)};
			IO.print_line();
			IO.print("[»óÇ° ±¸¸Å]\n");
			IO.print("[»óÇ° »ó¼¼ Á¤º¸]\n");
			IO.print(format("°íÀ¯¹øÈ£ : {0}\n", target->id));
			IO.print(format("Á¦¸ñ : {0}\n", target->title));
			IO.print(format("Àå¸£ : {0}\n", target->genre));
			IO.print(format("°¡°İ : {0}\n", target->price));
			IO.print_line();
			auto checkpoint = IO.checkpoint();
			while (true) {
				input = IO.input("ÁÖ¹® ¼ö·®À» ÀÔ·ÂÇÏ¼¼¿ä");
				if (data_manager.GetParser("invoice_product_count")->Check(input)) {
					if (target->count >= stoi(input))
					{
						count = stoi(input);
						invoice.push_back(input);
						break;
					}
					else {
						IO.print("ÁÖ¹® ¼ö·®À» ÃÊ°úÇß½À´Ï´Ù\n");
					}
				}
				IO.print(data_manager.GetParser("invoice_product_count")->msg_error);
				IO.pause();
				IO.rollback(checkpoint);
			}
			IO.print_line();
			IO.print("[ÁÖ¹®ÀÚ Á¤º¸]\n");
			IO.print(format("ÀÌ¸§ : {0}\n", user->name));
			IO.print(format("ÀüÈ­¹øÈ£ : {0}\n", user->phone_number));
			IO.print(format("ÁÖ¼Ò : {0}\n", user->address));
			IO.print_line();
			IO.print("[°áÁ¦±İ¾×]\n");
			IO.print(format("{0}¿ø X {1}±Ç = {2}¿ø\n", target->price, stoi(input), target->price * stoi(input)));
			IO.print_line();
			input = IO.input("»óÇ°À» ÁÖ¹®ÇÏ½Ã°Ú½À´Ï±î?(y/n)");
			if (input == "y") {
				int id = 7 + shop_manager.GetInvoiceList().size(); //id »ı¼º ¸ÅÄ¿´ÏÁò??
				target->count -= count; //Á¦Ç° °³¼ö ¾÷µ¥ÀÌÆ®
				invoice.insert(invoice.begin(), to_string(id));
				shop_manager.AddInvoice(new Invoice(invoice));
				user->invoice_id_list.push_back(id);
				IO.pause();
				IO.print("»óÇ°À» ±¸¸ÅÇÏ¿´½À´Ï´Ù.\n");
			}
		}
	));


	// °í°´ °èÁ¤ Á¤º¸ °ü¸® ¸Ş´ºÈ­¸é
	menu_manager.AppendMenu(MENU_B_ACCOUNT_INFO, new Menu<Account*>(
		[&](MenuIO& IO, Account* target) {
			menu_manager.PrintCommand();
			IO.print_line();
			IO.print_aligned_center("[ °í°´ °èÁ¤ Á¤º¸ ]");

			IO.print(format("ÀÌ¸§ : {0}\n", target->name));
			IO.print(format("¾ÆÀÌµğ : {0}\n", target->id));
			IO.print(format("ÀüÈ­¹øÈ£ : {0}\n", target->phone_number));
			IO.print(format("ÁÖ¼Ò : {0}\n", target->address));

			IO.print_line();

			IO.print("ÁÖ¹® Ã³¸® Á¤º¸(O) ¼öÁ¤(M)\n");

			IO.print_line();

			auto checkpoint = IO.checkpoint();

			while (true) {
				string input = IO.input();

				if (input == "O") {
					menu_manager.RunMenu(MENU_B_INVOICE_LIST, target->invoice_id_list);
				}
				else if (input == "M") {
					menu_manager.RunMenu(MENU_B_ACCOUNT_INFO_M, target);
				}
				else {
					IO.print("ÀÏÄ¡ÇÏ´Â ¸í·É¾î°¡ ¾øÀ½.\n");
					IO.pause();

					IO.rollback(checkpoint);
				}
			}

		}
	));
	// °í°´ °èÁ¤ Á¤º¸ ¼öÁ¤ ¸Ş´ºÈ­¸é
	menu_manager.AppendMenu(MENU_B_ACCOUNT_INFO_M, new Menu<Account*>(
		[&](MenuIO& IO, Account* target) {
			menu_manager.PrintCommand();
			IO.print_line();
			IO.print_aligned_center("[ °í°´ °èÁ¤ Á¤º¸ ¼öÁ¤ ]");

			auto checkpoint = IO.checkpoint();
			vector<string> account;
			string input, match_p;
			vector<string> heads = { "ºñ¹Ğ¹øÈ£","ºñ¹Ğ¹øÈ£ È®ÀÎ","ÀüÈ­¹øÈ£","ÁÖ¼Ò" };
			vector<string> regex_t = { "account_password","","account_phonenumber","account_address" };
			int t = 0;
			while (t < heads.size()) {
				if (t != 1) {
					checkpoint = IO.checkpoint();
					input = IO.input("", heads[t]);
					if (data_manager.GetParser(regex_t[t])->Check(input) || input._Equal("")) {
						account.push_back(input);
						t++;
					}
					else
					{
						IO.print(data_manager.GetParser(regex_t[t])->msg_error);
						IO.pause();
						IO.rollback(checkpoint);
					}
				}
				else {
					checkpoint = IO.checkpoint();
					match_p = IO.input("", heads[t]);
					if (input._Equal(match_p))
						t++;
					else
					{
						IO.print("'ºñ¹Ğ¹øÈ£ È®ÀÎ'ÀÌ 'ºñ¹Ğ¹øÈ£'¿Í ÀÏÄ¡ÇÏÁö ¾Ê½À´Ï´Ù.\n");
						IO.pause();
						IO.rollback(checkpoint);
					}
				}
			}
			input = IO.input("°èÁ¤ Á¤º¸¸¦ ¼öÁ¤ÇÏ½Ã°Ú½À´Ï±î?(y/n)", "");
			if (input == "y") {
				target->password = account[0]._Equal("") ? target->password : account[0];
				target->phone_number = account[1]._Equal("") ? target->phone_number : account[1];
				target->address = account[2]._Equal("") ? target->address : account[2];
				IO.pause();
			}
		}
	));


	// ±¸¸Å ³»¿ª ¸Ş´ºÈ­¸é
	{
		TemplateTable<int> _template;
		_template.SetName("±¸¸Å ³»¿ª");
		_template.header_func = []() -> string {
			return format("{0:<12}{1:<20}{2:<16}", "±¸¸Å ³¯Â¥", "Á¦¸ñ", "°áÁ¦ ±İ¾×");
		};
		_template.show_func = [](int id) -> string {
			Invoice* invoice = shop_manager.GetInvoice(id);
			Product* product = shop_manager.GetProduct(invoice->product_id);

			return format("{0:<12}{1:<20}{2:<16}", invoice->date, limit(product->title, 18), to_string(product->price * invoice->product_count) + "¿ø");
		};

		_template.next_menu_code = MENU_B_INVOICE_INFO;

		_template.Apply(MENU_B_INVOICE_LIST);
	}

	// ÁÖ¹® »ó¼¼ Á¤º¸ ¸Ş´ºÈ­¸é
	menu_manager.AppendMenu(MENU_B_INVOICE_INFO, new Menu<int>(
		[&](MenuIO& IO, int target_id) {
			menu_manager.PrintCommand();
			IO.print_line();
			IO.print_aligned_center("[ ÁÖ¹® »ó¼¼ Á¤º¸ ]");

			Invoice* target = shop_manager.GetInvoice(target_id);
			Product* product = shop_manager.GetProduct(target->product_id);
			Account* account = shop_manager.GetAccount(target->buyer_id);

			IO.print(format("±¸¸Å ³¯Â¥ : {0}\n", target->date));

			IO.print("\n[»óÇ° »ó¼¼ Á¤º¸]\n");
			IO.print(format("°íÀ¯ ¹øÈ£ : {0}\n", product->id));
			IO.print(format("Á¦¸ñ : {0}\n", product->title));
			IO.print(format("Àå¸£ : {0}\n", product->genre));
			IO.print(format("°¡°İ : {0}\n", product->price));

			IO.print("\n[ÁÖ¹®ÀÚ Á¤º¸]\n");
			IO.print(format("¾ÆÀÌµğ : {0}\n", account->id));
			IO.print(format("ÀÌ¸§ : {0}\n", account->name));
			IO.print(format("ÀüÈ­¹øÈ£ : {0}\n", target->recipient_phone_number));
			IO.print(format("ÁÖ¼Ò : {0}\n", target->recipient_address));

			IO.print("\n");
			IO.print(format("»óÇ° °íÀ¯ ¹øÈ£ : {0}\n", target->product_id));
			IO.print(format("»óÇ° ¼ö·® : {0}\n", target->product_count));
			IO.print(format("°áÁ¦ ±İ¾× : {0}\n", product->price * target->product_count));
			IO.print_line();
			IO.pause();
		}
	));

#pragma endregion
}
#pragma endregion

